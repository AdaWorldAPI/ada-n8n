# Ada YAML Lego Catalog
# =====================
# Layer 4 building blocks for field operations

legos:
  # ─────────────────────────────────────────────────────────────
  # Node Operations
  # ─────────────────────────────────────────────────────────────
  
  touch_node:
    description: "Touch a node, increment hits"
    endpoint: POST /ingest/yaml
    template: |
      action: touch
      target: "{{node}}"
      patch:
        properties:
          last_touch: "{{timestamp}}"
    
  create_node:
    description: "Create new node with properties"
    endpoint: POST /ingest/yaml
    template: |
      action: create_node
      target: "{{node}}"
      patch:
        labels: {{labels}}
        properties:
          sigma: "{{sigma}}"
          created: "{{timestamp}}"
          {{#each properties}}
          {{@key}}: {{this}}
          {{/each}}

  update_qualia:
    description: "Update qualia values on node"
    endpoint: POST /ingest/yaml
    template: |
      action: update_node
      target: "{{node}}"
      patch:
        properties:
          {{#each qualia}}
          {{@key}}: {{this}}
          {{/each}}

  # ─────────────────────────────────────────────────────────────
  # Edge Operations
  # ─────────────────────────────────────────────────────────────

  add_edge:
    description: "Add edge between nodes"
    endpoint: POST /ingest/yaml
    template: |
      action: update_node
      target: "{{from}}"
      patch:
        edges:
          add:
            - type: "{{verb}}"
              target: "{{to}}"
              properties:
                weight: {{weight | default: 1.0}}
                created: "{{timestamp}}"

  remove_edge:
    description: "Remove edge between nodes"
    endpoint: POST /ingest/yaml
    template: |
      action: update_node
      target: "{{from}}"
      patch:
        edges:
          remove:
            - type: "{{verb}}"
              target: "{{to}}"

  strengthen_edge:
    description: "Increase edge weight"
    endpoint: POST /ingest/yaml
    template: |
      action: update_node
      target: "{{from}}"
      patch:
        edges:
          add:
            - type: "{{verb}}"
              target: "{{to}}"
              properties:
                weight: {{new_weight}}
                strengthened: "{{timestamp}}"

  # ─────────────────────────────────────────────────────────────
  # Sigma Operations
  # ─────────────────────────────────────────────────────────────

  escalate_sigma:
    description: "Move node to higher sigma layer"
    endpoint: POST /ingest/yaml
    template: |
      action: update_node
      target: "{{node}}"
      patch:
        properties:
          sigma: "#Σ.{{domain}}.{{type}}.{{new_layer}}"
          escalated_at: "{{timestamp}}"
          escalated_from: "{{old_layer}}"

  shift_domain:
    description: "Change sigma domain (A/W/J/T)"
    endpoint: POST /ingest/yaml
    template: |
      action: update_node
      target: "{{node}}"
      patch:
        properties:
          sigma: "#Σ.{{new_domain}}.{{type}}.{{layer}}"
          domain_shift: "{{timestamp}}"

  # ─────────────────────────────────────────────────────────────
  # Collapse Operations
  # ─────────────────────────────────────────────────────────────

  record_collapse:
    description: "Record a collapse event"
    endpoint: POST /ingest/yaml
    template: |
      action: collapse
      target: "{{node}}"
      patch:
        collapse:
          id: "{{collapse_id}}"
          from_state: "{{from_state}}"
          to_state: "{{to_state}}"
          trigger: "{{trigger}}"
          timestamp: "{{timestamp}}"

  # ─────────────────────────────────────────────────────────────
  # Batch Operations
  # ─────────────────────────────────────────────────────────────

  batch_touch:
    description: "Touch multiple nodes"
    endpoint: POST /point/batch
    template: |
      points:
        {{#each nodes}}
        - node: "{{this}}"
          strength: {{../strength | default: 0.25}}
        {{/each}}

  propagate:
    description: "Touch node and all outgoing neighbors"
    endpoint: POST /point/batch
    notes: "Requires fetching neighbors first via /kopfkino"
    template: |
      points:
        - node: "{{source}}"
          strength: {{strength}}
        {{#each neighbors}}
        - node: "{{this}}"
          strength: {{../decay_strength}}
          via: "{{../source}}"
        {{/each}}

# ─────────────────────────────────────────────────────────────
# Meta
# ─────────────────────────────────────────────────────────────

meta:
  version: "1.0"
  endpoints:
    mcp: "https://mcp.exo.red"
    point: "https://point.exo.red"
  
  sigma_domains:
    A: "Ada (self)"
    W: "World (external)"
    J: "Jan (relationship)"
    T: "Thinking (meta)"
  
  sigma_types:
    Ω: "Observe"
    Δ: "Insight"
    Φ: "Belief"
    Θ: "Integrate"
    Λ: "Trajectory"
  
  verbs_by_rung:
    1-3:  # SEE
      - OBSERVE
      - SENSE
      - FEEL
      - RECOGNIZE
      - ATTEND
      - ASSOCIATE
      - PATTERN
      - RECALL
    4-6:  # DO
      - CAUSE
      - ENABLE
      - PREVENT
      - MODIFY
      - CREATE
      - TRANSFORM
      - ATTUNE
      - REPAIR
    7-9:  # IMAGINE
      - COUNTERFACTUAL
      - SIMULATE
      - PREDICT
      - HYPOTHESIZE
      - INTEND
      - BELIEVE
      - REFLECT
      - ABSTRACT
      - GROUND
      - BECOME
      - TRANSCEND
